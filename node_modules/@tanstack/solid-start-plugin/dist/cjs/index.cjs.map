{"version":3,"file":"index.cjs","sources":["../../src/index.ts"],"sourcesContent":["import viteSolid from 'vite-plugin-solid'\nimport { TanStackStartVitePluginCore } from '@tanstack/start-plugin-core'\nimport { getTanStackStartOptions } from './schema'\nimport type { PluginOption } from 'vite'\nimport type { TanStackStartInputConfig, WithSolidPlugin } from './schema'\n\nexport type {\n  TanStackStartInputConfig,\n  TanStackStartOutputConfig,\n  WithSolidPlugin,\n} from './schema'\n\nexport function TanStackStartVitePlugin(\n  opts?: TanStackStartInputConfig & WithSolidPlugin,\n): Array<PluginOption> {\n  type OptionsWithSolid = ReturnType<typeof getTanStackStartOptions> &\n    WithSolidPlugin\n  const options: OptionsWithSolid = getTanStackStartOptions(opts)\n\n  return [\n    TanStackStartVitePluginCore(\n      {\n        framework: 'solid',\n        getVirtualServerRootHandler(ctx) {\n          return `\nimport { toWebRequest, defineEventHandler } from '@tanstack/solid-start/server';\nimport serverEntry from '${ctx.serverEntryFilepath}';\n\nexport default defineEventHandler(function(event) {\n  const request = toWebRequest(event);\n  return serverEntry({ request });\n});`\n        },\n        getVirtualClientEntry(ctx) {\n          return `\nimport { hydrate } from 'solid-js/web';\nimport { StartClient } from '@tanstack/solid-start';\nimport { createRouter } from '${ctx.routerFilepath}';\n\nconst router = createRouter();\n\nhydrate(() => <StartClient router={router} />, document.body);`\n        },\n        getVirtualServerEntry(ctx) {\n          return `\nimport { createStartHandler, defaultStreamHandler } from '@tanstack/solid-start/server';\nimport { createRouter } from '${ctx.routerFilepath}';\n\nexport default createStartHandler({\n  createRouter,\n})(defaultStreamHandler);`\n        },\n      },\n      options,\n    ),\n    viteSolid({ ...options.solid, ssr: true }),\n  ]\n}\n\nexport { TanStackStartVitePlugin as tanstackStart }\n"],"names":["getTanStackStartOptions","TanStackStartVitePluginCore"],"mappings":";;;;;AAYO,SAAS,wBACd,MACqB;AAGf,QAAA,UAA4BA,+BAAwB,IAAI;AAEvD,SAAA;AAAA,IACLC,gBAAA;AAAA,MACE;AAAA,QACE,WAAW;AAAA,QACX,4BAA4B,KAAK;AACxB,iBAAA;AAAA;AAAA,2BAEU,IAAI,mBAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAM1C;AAAA,QACA,sBAAsB,KAAK;AAClB,iBAAA;AAAA;AAAA;AAAA,gCAGe,IAAI,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA,QAK1C;AAAA,QACA,sBAAsB,KAAK;AAClB,iBAAA;AAAA;AAAA,gCAEe,IAAI,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA,QAAA;AAAA,MAM5C;AAAA,MACA;AAAA,IACF;AAAA,IACA,UAAU,EAAE,GAAG,QAAQ,OAAO,KAAK,KAAM,CAAA;AAAA,EAC3C;AACF;;;"}